program: run_speech_recognition_ctc_zaion.py
name: hf-lebenchmark7k-hmhm-hpsearch
method: random
# method: grid
# method: bayes
metric:
  name: eval/loss
  goal: minimize
parameters:
  learning_rate:
    values: [7.5e-5, 1e-4, 3e-4]
  attention_dropout:
    values: [0, 0.05, 0.1, 0.2]
  activation_dropout:
    values: [0, 0.05, 0.1, 0.2]
  hidden_dropout:
    values: [0, 0.05, 0.1, 0.2]
  feat_proj_dropout:
    values: [0, 0.05, 0.1, 0.2]
  mask_time_prob:
    values: [0, 0.05, 0.1, 0.2]
command:
  - ${env}
  - ${interpreter}
  - ${program}
  - "--train_file"
  - "/home/bhuang/corpus/speech/internal/hm_hm/train_hmhm_190h.csv"
  - "--validation_file"
  - "/home/bhuang/corpus/speech/internal/hm_hm/test_hmhm_10h.csv"
  - "--dataset_config_name"
  - "fr"
  - "--text_column_name"
  - "wrd"
  - "--audio_column_name"
  - "wav"
  - "--min_duration_in_seconds"
  - "0.5"
  - "--length_column_name"
  - "input_length"
  - "--group_by_length"
  - "True"
  - "--model_name_or_path"
  - "LeBenchmark/wav2vec2-FR-7K-large"
  - "--output_dir"
  - "./outputs/hmhm/wav2vec2-FR-7K-large-sweep"
  - "--overwrite_output_dir"
  - "True"
  - "--preprocessing_num_workers"
  - "1"
  - "--dataloader_num_workers"
  - "1"
  - "--num_train_epochs"
  - "6"
  - "--per_device_train_batch_size"
  - "16"
  - "--per_device_eval_batch_size"
  - "8"
  - "--gradient_accumulation_steps"
  - "8"
  - "--gradient_checkpointing"
  - "True"
  - "--warmup_ratio"
  - "0.1"
  - "--evaluation_strategy"
  - "steps"
  - "--eval_steps"
  - "200"
  - "--logging_steps"
  - "100"
  - "--run_name"
  - $WANDB_NAME
  - "--save_steps"
  - "200"
  - "--save_total_limit"
  - "3"
  - "--load_best_model_at_end"
  - "True"
  - "--layerdrop"
  - "0"
  - "--attention_dropout"
  - "0"
  - "--activation_dropout"
  - "0.1"
  - "--hidden_dropout"
  - "0"
  - "--feat_proj_dropout"
  - "0"
  - "--final_dropout"
  - "0"
  - "--mask_feature_length"
  - "10"
  - "--mask_feature_prob"
  - "0"
  - "--mask_time_length"
  - "10"
  - "--mask_time_prob"
  - "0.05"
  - "--freeze_feature_encoder"
  - "True"
  - "--ctc_zero_infinity"
  - "True"
  - "--fp16"
  - "True"
  - "--do_train"
  - "True"
  - "--do_eval"
  - "True"
  - ${args}
early_terminate:
  type: hyperband
  min_iter: 200



  # - "--report_to"
  # - "wandb"